<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <link href="styles.css" rel="stylesheet" type="text/css" />

  <script>
    let summar = 0;
		//Данные переменные являются хранилищем индексов карточек и собственно, самих карточек
    let mas_num = [];
    let mas_card = [
      { img: "image/x.jpg", name: "Fantastic Four", count_from: 6, count_to: 4 }, { img: "image/b.jpg", name: "Deadpool", count_from: 7, "count_to": 5 }, { img: "image/c.jpg", name: "Superman", count_from: 8, count_to: 6 }, { img: "image/v.jpg", name: "Batman", count_from: 5, count_to: 4 }, { img: "image/z.jpg", name: "spiderman", count_from: 7, count_to: 4 }
    ];
    let min = Math.ceil(0);
    let max = Math.floor(4);
    let r_z;
    let mas_index = [];
	//Эта функция отвечает за динамическое добавление товара в корзину
    function sum_write(t) {
      document.getElementsByClassName("count_pay")[0].innerHTML = ++summar;
	   let div = document.createElement('div');
	  div.className = 'create_div';
	  let button = document.createElement('button');
	  button.onclick = function(){this.parentElement.remove(); summar--; document.getElementsByClassName("count_pay")[0].innerHTML = summar;};
	  button.innerHTML = 'Удалить';
	   div.innerHTML = "<img src="+mas_card[mas_num[t]].img+" height='100%' width='15%'/><div class='cart_product'><p><b>Наименование товара</b>:комикс "+mas_card[mas_num[t]].name+"</p><p><b>Цена товара</b>:"+mas_card[mas_num[t]].count_to+"</p></div>";
	   div.appendChild(button);
	  document.getElementsByClassName('popup')[0].appendChild(div);  
    }

    //function For_Date(){
    //let d = new Date();
    //let sd = document.getElementById("ss");
    //let ds = "Регистрация. Сегодня:"+d.getDate()+' '+mas_Month[d.getMonth()]+' '+d.getFullYear()+' '+d.getHours()+":"+d.getMinutes()+":"+d.getSeconds();
    //sd.textContent = ds;
    //};


 //Эта функция отвечает за рандомную генерацию товара из списка
    function rand(id, d_id) {
      r_z = Math.floor(Math.random() * (max - min)) + min;
      if (mas_index.indexOf(r_z) != -1) rand(id, d_id); else {
        mas_index.push(r_z);
        id.src = mas_card[r_z].img;
        d_id.innerHTML = '<p>Цена товара раньше: ' + mas_card[r_z].count_from + '$</p><p>Цена сейчас: ' + mas_card[r_z].count_to + '$</p>';
        mas_num.push(r_z);
      }
    }
	
	function visual_garbage(){
	document.getElementsByClassName('layer')[0].style.display = document.getElementsByClassName('loadbar')[0].style.display = 'block';
	let load = document.getElementsByClassName('loadbar')[0];
	let timer=0;
	let timer_loadbar = setInterval(()=>{
	if(load.value==load.max)load.value=10;
	else load.value++;
	timer+=50;
	},50);
		let promise = new Promise(function(resolve,reject){
	 setTimeout(()=>{
	 clearInterval(timer_loadbar);
	 if(summar>0)resolve("Товары есть");else reject(new Error("Товаров нет"));
	 } ,10000);
	 });
	 promise.finally(
	 ()=>load.style.display='none'
	 )
promise.then(
	result=>document.getElementsByClassName('popup')[0].style.display='block',
	error=>{alert(error);document.getElementsByClassName('layer')[0].style.display='none'; load.value=0;}
	);
	
	
	
	}
	
  
  </script>
</head>

<body>

<div class="layer"></div>
<progress value='0' max='100' class="loadbar"></progress>
 <div class="popup">

  <p class="close" onclick="document.getElementsByClassName('popup')[0].style.display=document.getElementsByClassName('layer')[0].style.display='none';">+</p>
<h4>Ваши товары</h4>
</div>

  <header class="fix">


    <div class="logo">
      <img src="image/marvel.jpg" width="65px" />
      <h1><span class="letter">C</span>omics<span class="letter">T</span>rip</h1><img src="image/dc.png" width="50px" />
    </div>


    <div class="reg">
      <a href="">Вход</a>/<a href="">Регистрация</a>
    </div>


    <div class="pay-cart">
      <button onclick="if(summar!=0) document.getElementsByClassName('popup')[0].style.display=document.getElementsByClassName('layer')[0].style.display='block';">
        <div class="count_pay">0</div><img src="image/cart.svg" />
      </button><br>
    </div>
  </header>
  
 
  

  <nav width="100%" height="50px">
    <b>
      <ul>
        <li class="point_menu">Главная<img src="image/triangle.png" width="20px" height="20px" />
          <ul class="podmenu">
            <li>Новости</li>
            <li>Интересное</li>
          </ul>
        </li>
        <li class="point_menu">Магазин<img src="image/triangle.png" width="20px" height="20px" />
          <ul class="podmenu">
            <li>Каталог</li>
            <li>Акции</li>
          </ul>
        </li>
        <li class="point_menu">О нас<img src="image/triangle.png" width="20px" height="20px" />
          <ul class="podmenu">
            <li>Контакты</li>
            <li>Справка о сайте</li>
          </ul>
        </li>
		</ul>
    </b>
  </nav>
  
  
  <section>
    <div class="wrapper-video">
      <video align="center" autoplay="autoplay" loop="loop" muted="muted">
        <source src="q.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>
      </video>
    </div>
  </section>
  <section>

    <div class="articles">
      <div width="100%">
        <marquee behavior="alternate">
          <h3>Последние новости</h3>
        </marquee>
      </div>

      <div class="buttons">
        <button class="button_left"><<</button>
            <button class="button_right">>></button>
      </div>
	  
      <div class="news_line"><img src="image/avengers.jpg"  height="100%"/>
	  <div class="stat">
	  <h4>Мстители - финал:конец истории?</h4>
	  <p>Недавно вышел фильм мстители: финал, который был, безусловно ожидаемый, но был принят по разному. Одно нельзя отрицать - фильм продемонстрировал огромный размах мультивселенной. Для большей информации Вы можете прочитать статью о фильме.</p>
	  </div>
	  </div>
	  
      <div class="news_block"><img src="image/marvel avengers.jpg"  height="100%" />
	  <div class="stat">
	  <h4>Марвел:мстители - игра про баги</h4>
	  <p>Ожидаемая игра по мстителям, наконец, вышла. Но ее оценки были, мягко говоря, не очень. Что же так разгневало критиков?</p>
	  </div>
	  </div>
	  
      <div class="news_line"><img src="image/captain America.jpg"  height="100%" />
	  <div class="stat">
	  <h4>Новый капитан Америка может появится в Докторе Стрэндж 2</h4>
	  <p>(В статье присутствуют спойлеры) Тех, кто посмотрел мстители: финал, интересует дальнейшая судьба капитана Америки. Планы Марвел на него Вы можете узнать в статье.</p>
	  </div>
	  </div>
	  
      <div class="news_block"><img src="image/spider.webp"  height="100%" />
	  <div class="stat">
	  <h4>Насколько Ты фанат Паучка?</h4>
	  <p>В новом Человеке-пауке на PS4 оказалось множество отсылок на первые комиксы о супергерое. Проверь себя, нашел ли ты их все?</p>
	  </div>
	  </div>
	  
    </div>


  </section>

  <section class="count">

    <div class="product">
      <img id="id1" width="100%" height="80%" />
      <button class="pay" onclick="sum_write('0')" align="center"><img src="image/cart.svg" width="24px"
          height="24px" /></button>
      <div align="center" id="d1">

      </div>
    </div>
    <script>rand(id1, d1)</script>
    <div class="product">
      <img id="id2" width="100%" height="80%" />
      <button class="pay" onclick="sum_write(1)" align="center"><img src="image/cart.svg" width="24px"
          height="24px" /></button>
      <div align="center" id="d2">

      </div>
    </div>
    <script>rand(id2, d2)</script>
    <div class="product">
      <img id="id3" width="100%" height="80%" />
      <button class="pay" onclick="sum_write(2)" align="center"><img src="image/cart.svg" width="24px"
          height="24px" /></button>
      <div align="center" id="d3">

      </div>
    </div>
    <script>rand(id3, d3)</script>
    <footer>
      <h2>
        <font color="white">Акционные предложения</font>
      </h2><button class="b1" onclick="visual_garbage();">Узнать больше</button>
    </footer>
  </section>
  <footer class="foot">
    <h3>Позвоните нам!</h3><img src="image/tel.png" width="30px" height="30px" />
  </footer>




</body>

</html>